# Digital Signal Processing Library

Homeworks and projects of Advanced DSP course.

To run the programs, make sure the required dependencies are installed. If not, the dependencies can be installed by the command:

```
pip3 install -r requirements.txt
```

Every `.py` program includes a simple test and can run directly to see how it works. 

SSIM and JPEG related programs requires an image file to run.

## Documentation

### Digital Filter

In `mini_max.py`:

```python
def mini_max_filter(
    length, 
    passbd, 
    transbd, 
    weight, 
    analog_intv
):
```

Generates a digital low-pass/high-pass filter by the mini-max method and returns the impulse response (1D NumPy array).

The frequency response of the digital filter and the desired filter will also be plotted.

Arguments:

- `length: int`
Length (number of points) of the filter.
- `passbd: List[float, float]`
Boundaries of the passband, e.g. `[0, 0.2]`.
- `transbd: List[float, float]`
Boundaries of the transition band, e.g. `[0.2, 0.3]`.
- `weight: Dict{str: float}`
Weight of passband and stopband, e.g. `{"pass": 1, "stop": 0.5}`.
- `analog_intv: float`
Analog frequency interval, e.g. `0.001`.

### Discrete Hilbert Transform

In `Hilbert_transform_fs.py`:

```python
def freq_sampling_Hilbert(k):
```

Generates a Hilbert transform filter by frequency sampling method and returns the impulse response (1D NumPy array).

Arguments:

- `k: int`
The length of the filter will be `2k+1`.

### Music Generation

In `number_music.py`:

```python
def numbers_to_music(
    score, 
    beat, 
    name='music', 
    bpm=180, 
    f_base=524,
    chord=[], 
    chord_beat=[], 
    tc=0.5, 
    fs=22050
):
```

Generate music file (.wav) by simplified music notation.

Arguments:

- `score: List[int or float]`
Music score in simplified music notation. Invalid numbers (which does not coordinates to an actual note) will produce errors.
- `beat: List[int or float]`
Duration of notes in `score` using beat as unit. `beat` hould have the same length as `score`.
- `name: str`
Generated file name (without .wav extension).
- `bpm: int`
Beat per minute. Larger `bpm` makes the music sound more fast-paced.
- `f_base: int or float`
Frequency of the base note C, by default using the 440 Hz standard.
- `chord: List[int or float or List]`
- `chord_beat: List[int or float]`
`chord` and `chord_beat` work the same way as `score` and `beat`, except that `chord` can contain chords (more than one note) as a single note.
- `tc: float`
Time constant for notes to decay. Larger `tc` makes notes decay faster.
- `fs: int or float`
Sampling frequency.

### Structural Similarity Measurement

In `SSIM.py`:

```python
def SSIM(A, B, c1, c2):
```

Returns the structural similarity between image `A` and `B`.

Arguments:

- `A`, `B`: 3D NumPy arrays
- `c1`, `c2`: adjustable constants

### Number Theoretic Transform

In `ntt_mat`:

```python
def NTTm(N, M):
```

Returns the forwards and inverse number theoretic transform matrices (2D NumPy arrays).

Arguments:

- `N: int`
Size of the transform matrices. Both matrices will have shape `(N, N)`.
- `M: int`
Number theory modulus.

### Prime Factor Algorithm

In `prime_factor_dft.py`:

```python
def prime_factor_dft(x):
```

Returns the discrete Fourier transform (DFT) of the 1D signal `x`.
The DFT is performed with prime factor algorithm, which is faster than $O(n^2)$.

Arguments:

- `x`: 1D NumPy array
The target signal of the DFT.

### JPEG Image Compression

In `JPEG.py`:

```python=
def JPEG_compress(img):
```

Returns compressed image data.
For more details of the return types, check out the arguments of `JPEG_extract()`.

The compressed data is stored as strings containing only two characters, `"0"`, `"1"`, rather than actual bytes.
The returned data are gathered in a Python dictionary and stored in a json file, so the file size may actually be larger than the size of the original image file.

To see the compression results, changes the file name in `jpeg_data.py` to the json file generated by `JPEG.py` and run the `jpeg_data.py` program.
The program prints out the image data size and compressed image data size in terms of actual bits and bytes. One can compare the two data sizes to see the effect of JPEG compression.

Arguments:

- `img`: 3D NumPy array image (colored) to be compressed. Must have dimensions `(h, w, 3)`, where `h`, `w` are integers.

```python
def JPEG_extract(data, code, dim, mode):
```

Returns the recovered image (3D NumPy array) by the compressed data.

Arguments:

- `data: List[str]`
Compressed data. Each string represent a bit sequence.
- `code: Dict{int: str}`
Huffman coding table (integer to bit strings).
- `dim: List[int]`
Dimension information for extraction.
- `mode: int`
YCbCr compression mode.
    - `444`: no compression
    - `422`: 4:2:2
    - `420`: 4:2:0
